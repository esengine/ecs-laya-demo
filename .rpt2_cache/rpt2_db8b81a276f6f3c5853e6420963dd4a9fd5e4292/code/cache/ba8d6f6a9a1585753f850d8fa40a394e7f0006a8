{
  "code": "import { SpawnerComponent } from \"../components/SpawnerComponent\";\r\nexport class SpawnerSystem extends es.EntityProcessingSystem {\r\n    constructor(matcher) {\r\n        super(matcher);\r\n    }\r\n    processEntity(entity) {\r\n        let spawner = entity.getComponent(SpawnerComponent);\r\n        if (spawner.numAlive <= 0)\r\n            spawner.enabled = true;\r\n        if (!spawner.enabled)\r\n            return;\r\n        if (spawner.cooldown <= -1) {\r\n            this.scheduleSpawn(spawner);\r\n            console.log(\"冷却时间已到，进入下一轮刷新 冷却时间:\", spawner.cooldown);\r\n            spawner.cooldown /= 4;\r\n        }\r\n        spawner.cooldown -= es.Time.deltaTime;\r\n        if (spawner.cooldown <= 0) {\r\n            this.scheduleSpawn(spawner);\r\n            for (let i = 0; i < RandomUtils.randint(spawner.minCount, spawner.maxCount); i++) {\r\n                console.log(\"创建敌人\", entity.position.x, entity.position.y, spawner.enemyType, entity);\r\n                spawner.numSpawned++;\r\n                spawner.numAlive++;\r\n            }\r\n            if (spawner.numAlive > 0)\r\n                spawner.enabled = false;\r\n        }\r\n    }\r\n    scheduleSpawn(spawner) {\r\n        spawner.cooldown = RandomUtils.randint(spawner.minInterval, spawner.maxInterval);\r\n    }\r\n}\r\n",
  "references": [
    "E:/ecs-laya-demo/src/components/SpawnerComponent.ts"
  ]
}
